# Sequence Diagrams - Admin (Quáº£n Trá»‹ Há»‡ Thá»‘ng)

## ðŸ“‹ Má»¥c Lá»¥c
1. [ÄÄƒng Nháº­p](#1-Ä‘Äƒng-nháº­p-login)
2. [Táº¡o Hoáº¡t Äá»™ng](#2-táº¡o-hoáº¡t-Ä‘á»™ng-create-activity)
3. [ThÃªm ThÃ nh ViÃªn Má»›i](#3-thÃªm-thÃ nh-viÃªn-má»›i-add-member)
4. [Duyá»‡t ThÃ nh ViÃªn CLB](#4-duyá»‡t-thÃ nh-viÃªn-clb-approve-membership)
5. [Duyá»‡t ÄÄƒng KÃ½ Tham Gia Hoáº¡t Äá»™ng](#5-duyá»‡t-Ä‘Äƒng-kÃ½-tham-gia-hoáº¡t-Ä‘á»™ng-approve-participant)
6. [Duyá»‡t Äiá»ƒm Danh](#6-duyá»‡t-Ä‘iá»ƒm-danh-approve-attendance)
7. [Xem Danh SÃ¡ch Hoáº¡t Äá»™ng](#7-xem-danh-sÃ¡ch-hoáº¡t-Ä‘á»™ng-list-activities)

---

## 1. ÄÄƒng Nháº­p (Login)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Admin    â”‚    â”‚   Frontend   â”‚    â”‚   API Route  â”‚    â”‚   Database   â”‚    â”‚  Membership  â”‚
â”‚             â”‚    â”‚              â”‚    â”‚  /api/auth/  â”‚    â”‚    (User)    â”‚    â”‚   Service    â”‚
â”‚             â”‚    â”‚              â”‚    â”‚    login     â”‚    â”‚              â”‚    â”‚  (Database)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚  1. Nháº­p email   â”‚                    â”‚                    â”‚                    â”‚
       â”‚     vÃ  máº­t kháº©u  â”‚                    â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚  2. POST /api/auth/login                â”‚                    â”‚
       â”‚                  â”‚     { email, password }                 â”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  3. Validate input â”‚                    â”‚
       â”‚                  â”‚                    â”‚     (email,        â”‚                    â”‚
       â”‚                  â”‚                    â”‚      password)     â”‚                    â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  4. TÃ¬m user theo  â”‚                    â”‚
       â”‚                  â”‚                    â”‚     email          â”‚                    â”‚
       â”‚                  â”‚                    â”‚     (exclude       â”‚                    â”‚
       â”‚                  â”‚                    â”‚      isDeleted)    â”‚                    â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  5. User document  â”‚                    â”‚
       â”‚                  â”‚                    â”‚     hoáº·c null      â”‚                    â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  6. Kiá»ƒm tra user  â”‚                    â”‚
       â”‚                  â”‚                    â”‚     tá»“n táº¡i?       â”‚                    â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  7. So sÃ¡nh máº­t    â”‚                    â”‚
       â”‚                  â”‚                    â”‚     kháº©u (bcrypt.  â”‚                    â”‚
       â”‚                  â”‚                    â”‚     compare)       â”‚                    â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  8. Táº¡o JWT token  â”‚                    â”‚
       â”‚                  â”‚                    â”‚     vá»›i user info  â”‚                    â”‚
       â”‚                  â”‚                    â”‚     (userId,       â”‚                    â”‚
       â”‚                  â”‚                    â”‚      studentId,    â”‚                    â”‚
       â”‚                  â”‚                    â”‚      name, email,  â”‚                    â”‚
       â”‚                  â”‚                    â”‚      role)         â”‚                    â”‚
       â”‚                  â”‚                    â”‚     expiresIn: 7d  â”‚                    â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  9. Kiá»ƒm tra       â”‚                    â”‚
       â”‚                  â”‚                    â”‚     Membership     â”‚                    â”‚
       â”‚                  â”‚                    â”‚     Status         â”‚                    â”‚
       â”‚                  â”‚                    â”‚     TÃ¬m membership â”‚                    â”‚
       â”‚                  â”‚                    â”‚     má»›i nháº¥t theo  â”‚                    â”‚
       â”‚                  â”‚                    â”‚     userId         â”‚                    â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  10. Membership    â”‚                    â”‚
       â”‚                  â”‚                    â”‚      document      â”‚                    â”‚
       â”‚                  â”‚                    â”‚      (hoáº·c null)   â”‚                    â”‚
       â”‚                  â”‚                    â”‚      vá»›i status    â”‚                    â”‚
       â”‚                  â”‚                    â”‚      (ACTIVE/      â”‚                    â”‚
       â”‚                  â”‚                    â”‚       PENDING/     â”‚                    â”‚
       â”‚                  â”‚                    â”‚       REJECTED/    â”‚                    â”‚
       â”‚                  â”‚                    â”‚       INACTIVE/    â”‚                    â”‚
       â”‚                  â”‚                    â”‚       REMOVED)     â”‚                    â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  11. XÃ¡c Ä‘á»‹nh      â”‚                    â”‚
       â”‚                  â”‚                    â”‚      effectiveRole â”‚                    â”‚
       â”‚                  â”‚                    â”‚      vÃ  redirectUrlâ”‚                    â”‚
       â”‚                  â”‚                    â”‚      [activate]    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  12. Logic xÃ¡c Ä‘á»‹nhâ”‚                    â”‚
       â”‚                  â”‚                    â”‚      redirectUrl:  â”‚                    â”‚
       â”‚                  â”‚                    â”‚      - SUPER_ADMIN/â”‚                    â”‚
       â”‚                  â”‚                    â”‚        CLUB_LEADER â”‚                    â”‚
       â”‚                  â”‚                    â”‚        â†’ /admin/   â”‚                    â”‚
       â”‚                  â”‚                    â”‚        dashboard   â”‚                    â”‚
       â”‚                  â”‚                    â”‚      - CLUB_DEPUTY/â”‚                    â”‚
       â”‚                  â”‚                    â”‚        CLUB_MEMBER â”‚                    â”‚
       â”‚                  â”‚                    â”‚        â†’ /officer/ â”‚                    â”‚
       â”‚                  â”‚                    â”‚        dashboard   â”‚                    â”‚
       â”‚                  â”‚                    â”‚      - CLUB_STUDENTâ”‚                    â”‚
       â”‚                  â”‚                    â”‚        /STUDENT    â”‚                    â”‚
       â”‚                  â”‚                    â”‚        â†’ /student/ â”‚                    â”‚
       â”‚                  â”‚                    â”‚        dashboard   â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  13. Override náº¿u  â”‚                    â”‚
       â”‚                  â”‚                    â”‚      membership.   â”‚                    â”‚
       â”‚                  â”‚                    â”‚      status ===    â”‚                    â”‚
       â”‚                  â”‚                    â”‚      'REMOVED':    â”‚                    â”‚
       â”‚                  â”‚                    â”‚      - CLUB_DEPUTY,â”‚                    â”‚
       â”‚                  â”‚                    â”‚        CLUB_MEMBER,â”‚                    â”‚
       â”‚                  â”‚                    â”‚        CLUB_STUDENTâ”‚                    â”‚
       â”‚                  â”‚                    â”‚        â†’ effective â”‚                    â”‚
       â”‚                  â”‚                    â”‚        Role: STUDENTâ”‚                    â”‚
       â”‚                  â”‚                    â”‚        redirectUrl: â”‚                    â”‚
       â”‚                  â”‚                    â”‚        /student/   â”‚                    â”‚
       â”‚                  â”‚                    â”‚        dashboard   â”‚                    â”‚
       â”‚                  â”‚                    â”‚      - CLUB_LEADER â”‚                    â”‚
       â”‚                  â”‚                    â”‚        â†’ giá»¯ admin â”‚                    â”‚
       â”‚                  â”‚                    â”‚        access      â”‚                    â”‚
       â”‚                  â”‚                    â”‚     [deactivate]   â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚  14. Response:     â”‚                    â”‚                    â”‚
       â”‚                  â”‚      { success:    â”‚                    â”‚                    â”‚
       â”‚                  â”‚        true,       â”‚                    â”‚                    â”‚
       â”‚                  â”‚        message,    â”‚                    â”‚                    â”‚
       â”‚                  â”‚        user: {     â”‚                    â”‚                    â”‚
       â”‚                  â”‚          _id,      â”‚                    â”‚                    â”‚
       â”‚                  â”‚          studentId,â”‚                    â”‚                    â”‚
       â”‚                  â”‚          name,     â”‚                    â”‚                    â”‚
       â”‚                  â”‚          email,    â”‚                    â”‚                    â”‚
       â”‚                  â”‚          role,     â”‚                    â”‚                    â”‚
       â”‚                  â”‚          effective â”‚                    â”‚                    â”‚
       â”‚                  â”‚          Role,     â”‚                    â”‚                    â”‚
       â”‚                  â”‚          phone,    â”‚                    â”‚                    â”‚
       â”‚                  â”‚          class,    â”‚                    â”‚                    â”‚
       â”‚                  â”‚          faculty,  â”‚                    â”‚                    â”‚
       â”‚                  â”‚          avatarUrl â”‚                    â”‚                    â”‚
       â”‚                  â”‚        },          â”‚                    â”‚                    â”‚
       â”‚                  â”‚        token,      â”‚                    â”‚                    â”‚
       â”‚                  â”‚        redirectUrl â”‚                    â”‚                    â”‚
       â”‚                  â”‚      }             â”‚                    â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚  15. LÆ°u token   â”‚                    â”‚                    â”‚                    â”‚
       â”‚      vÃ  user vÃ o â”‚                    â”‚                    â”‚                    â”‚
       â”‚      localStorageâ”‚                    â”‚                    â”‚                    â”‚
       â”‚      Cáº­p nháº­t    â”‚                    â”‚                    â”‚                    â”‚
       â”‚      auth state  â”‚                    â”‚                    â”‚                    â”‚
       â”‚      Äiá»u hÆ°á»›ng  â”‚                    â”‚                    â”‚                    â”‚
       â”‚      Ä‘áº¿n redirectUrlâ”‚                 â”‚                    â”‚                    â”‚
       â”‚      (Dashboard) â”‚                    â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
```

**Chi tiáº¿t:**
- **Actor**: Admin
- **Objects**: Frontend, API Route `/api/auth/login`, Database (User), Membership Service (Database)
- **Messages**: 
  1. Admin nháº­p email vÃ  máº­t kháº©u
  2. Frontend gá»­i POST request Ä‘áº¿n API
  3. API validate input (email, password)
  4-5. API tÃ¬m user trong database (exclude isDeleted)
  6. Kiá»ƒm tra user tá»“n táº¡i
  7. So sÃ¡nh máº­t kháº©u vá»›i bcrypt.compare()
  8. Táº¡o JWT token vá»›i user info (expiresIn: 7d)
  9-10. **Membership Service**: TÃ¬m membership má»›i nháº¥t theo userId
  11-13. XÃ¡c Ä‘á»‹nh effectiveRole vÃ  redirectUrl:
     - Dá»±a trÃªn user.role
     - Override náº¿u membership.status === 'REMOVED'
     - CLUB_LEADER giá»¯ admin access ngay cáº£ khi REMOVED
  14. API tráº£ vá» response vá»›i user, token, redirectUrl, effectiveRole
  15. Frontend lÆ°u token, cáº­p nháº­t auth state, vÃ  Ä‘iá»u hÆ°á»›ng

**Logic Membership Service:**
- TÃ¬m membership má»›i nháº¥t: `Membership.findOne({ userId }).sort({ createdAt: -1 })`
- XÃ¡c Ä‘á»‹nh effectiveRole:
  - Máº·c Ä‘á»‹nh: `effectiveRole = user.role`
  - Náº¿u `membership.status === 'REMOVED'`:
    - CLUB_DEPUTY, CLUB_MEMBER, CLUB_STUDENT â†’ `effectiveRole = 'STUDENT'`
    - CLUB_LEADER â†’ giá»¯ nguyÃªn role (admin access)
- XÃ¡c Ä‘á»‹nh redirectUrl:
  - SUPER_ADMIN, CLUB_LEADER â†’ `/admin/dashboard`
  - CLUB_DEPUTY, CLUB_MEMBER â†’ `/officer/dashboard`
  - CLUB_STUDENT, STUDENT â†’ `/student/dashboard`
  - Override náº¿u REMOVED (trá»« CLUB_LEADER) â†’ `/student/dashboard`

---

## 2. Táº¡o Hoáº¡t Äá»™ng (Create Activity)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Admin    â”‚    â”‚   Frontend   â”‚    â”‚   API Route  â”‚    â”‚   Database   â”‚    â”‚  Cloudinary  â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ /api/        â”‚    â”‚              â”‚    â”‚              â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ activities   â”‚    â”‚              â”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚  1. Äiá»n thÃ´ng   â”‚                    â”‚                    â”‚                    â”‚
       â”‚     tin hoáº¡t Ä‘á»™ngâ”‚                    â”‚                    â”‚                    â”‚
       â”‚     Chá»n Ä‘á»‹a Ä‘iá»ƒmâ”‚                    â”‚                    â”‚                    â”‚
       â”‚     trÃªn báº£n Ä‘á»“  â”‚                    â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚  2. Validate dá»¯    â”‚                    â”‚                    â”‚
       â”‚                  â”‚     liá»‡u Ä‘áº§u vÃ o   â”‚                    â”‚                    â”‚
       â”‚                  â”‚     [activate]     â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚  3. Náº¿u cÃ³ áº£nh:    â”‚                    â”‚                    â”‚
       â”‚                  â”‚     Upload áº£nh     â”‚                    â”‚                    â”‚
       â”‚                  â”‚     POST /api/     â”‚                    â”‚                    â”‚
       â”‚                  â”‚     upload/        â”‚                    â”‚                    â”‚
       â”‚                  â”‚     activity-image â”‚                    â”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  4. Upload áº£nh lÃªn â”‚                    â”‚
       â”‚                  â”‚                    â”‚     Cloudinary     â”‚                    â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  5. Image URL      â”‚                    â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚  6. Image URL      â”‚                    â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚  7. POST /api/     â”‚                    â”‚                    â”‚
       â”‚                  â”‚     activities     â”‚                    â”‚                    â”‚
       â”‚                  â”‚     { activityData }â”‚                   â”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  8. Kiá»ƒm tra xÃ¡c   â”‚                    â”‚
       â”‚                  â”‚                    â”‚     thá»±c (JWT)     â”‚                    â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  9. Validate dá»¯    â”‚                    â”‚
       â”‚                  â”‚                    â”‚     liá»‡u           â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  10. Kiá»ƒm tra      â”‚                    â”‚
       â”‚                  â”‚                    â”‚      responsible   â”‚                    â”‚
       â”‚                  â”‚                    â”‚      Person role   â”‚                    â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  11. User document â”‚                    â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  12. Táº¡o Activity  â”‚                    â”‚
       â”‚                  â”‚                    â”‚      object        â”‚                    â”‚
       â”‚                  â”‚                    â”‚      Set createdBy â”‚                    â”‚
       â”‚                  â”‚                    â”‚      Set updatedBy â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  13. LÆ°u Activity  â”‚                    â”‚
       â”‚                  â”‚                    â”‚      vÃ o database  â”‚                    â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  14. Activity savedâ”‚                    â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  15. Response:     â”‚                    â”‚
       â”‚                  â”‚                    â”‚      { success,    â”‚                    â”‚
       â”‚                  â”‚                    â”‚        data }      â”‚                    â”‚
       â”‚                  â”‚                    â”‚     [deactivate]   â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚  16. Response:     â”‚                    â”‚                    â”‚
       â”‚                  â”‚      { success,    â”‚                    â”‚                    â”‚
       â”‚                  â”‚        data }      â”‚                    â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
       â”‚  17. Hiá»ƒn thá»‹    â”‚                    â”‚                    â”‚                    â”‚
       â”‚      thÃ´ng bÃ¡o   â”‚                    â”‚                    â”‚                    â”‚
       â”‚      thÃ nh cÃ´ng  â”‚                    â”‚                    â”‚                    â”‚
       â”‚      Äiá»u hÆ°á»›ng  â”‚                    â”‚                    â”‚                    â”‚
       â”‚      Ä‘áº¿n trang   â”‚                    â”‚                    â”‚                    â”‚
       â”‚      chi tiáº¿t    â”‚                    â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚                    â”‚
```

**Chi tiáº¿t:**
- **Actor**: Admin
- **Objects**: Frontend, API Route `/api/activities`, Database (Activity, User), Cloudinary
- **Luá»“ng chÃ­nh**:
  1. Admin Ä‘iá»n form vÃ  chá»n Ä‘á»‹a Ä‘iá»ƒm
  2. Frontend validate dá»¯ liá»‡u
  3. Náº¿u cÃ³ áº£nh: Upload lÃªn Cloudinary
  4-6. Upload áº£nh vÃ  nháº­n URL
  7. Gá»­i POST request táº¡o activity
  8-11. API kiá»ƒm tra xÃ¡c thá»±c vÃ  quyá»n
  12-14. Táº¡o vÃ  lÆ°u Activity vÃ o database
  15-16. Tráº£ vá» response
  17. Frontend hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng

---

## 3. ThÃªm ThÃ nh ViÃªn Má»›i (Add Member)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Admin    â”‚    â”‚   Frontend   â”‚    â”‚   API Route  â”‚    â”‚   Database   â”‚
â”‚             â”‚    â”‚              â”‚    â”‚  /api/membersâ”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  1. Äiá»n form    â”‚                    â”‚                    â”‚
       â”‚     thÃ´ng tin    â”‚                    â”‚                    â”‚
       â”‚     thÃ nh viÃªn   â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  2. Validate form  â”‚                    â”‚
       â”‚                  â”‚     [activate]     â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  3. POST /api/     â”‚                    â”‚
       â”‚                  â”‚     members        â”‚                    â”‚
       â”‚                  â”‚     { studentId,   â”‚                    â”‚
       â”‚                  â”‚       name, email, â”‚                    â”‚
       â”‚                  â”‚       password,    â”‚                    â”‚
       â”‚                  â”‚       role, ... }  â”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  4. Kiá»ƒm tra xÃ¡c   â”‚
       â”‚                  â”‚                    â”‚     thá»±c (JWT)     â”‚
       â”‚                  â”‚                    â”‚     Kiá»ƒm tra role  â”‚
       â”‚                  â”‚                    â”‚     (CLUB_LEADER/  â”‚
       â”‚                  â”‚                    â”‚      SUPER_ADMIN)  â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  5. Validate dá»¯    â”‚
       â”‚                  â”‚                    â”‚     liá»‡u Ä‘áº§u vÃ o   â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  6. Kiá»ƒm tra user  â”‚
       â”‚                  â”‚                    â”‚     Ä‘Ã£ tá»“n táº¡i?    â”‚
       â”‚                  â”‚                    â”‚     (studentId,    â”‚
       â”‚                  â”‚                    â”‚      email)        â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  7. User exists?   â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  8. Hash password  â”‚
       â”‚                  â”‚                    â”‚     (bcrypt)       â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  9. Táº¡o User objectâ”‚
       â”‚                  â”‚                    â”‚     LÆ°u vÃ o DB     â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  10. User saved    â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  11. Táº¡o Membershipâ”‚
       â”‚                  â”‚                    â”‚      object        â”‚
       â”‚                  â”‚                    â”‚      status: ACTIVEâ”‚
       â”‚                  â”‚                    â”‚      approvedBy:   â”‚
       â”‚                  â”‚                    â”‚      admin.userId  â”‚
       â”‚                  â”‚                    â”‚      LÆ°u vÃ o DB    â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  12. Membership    â”‚
       â”‚                  â”‚                    â”‚      saved         â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  13. Response:     â”‚
       â”‚                  â”‚                    â”‚      { success,    â”‚
       â”‚                  â”‚                    â”‚        message,    â”‚
       â”‚                  â”‚                    â”‚        data }      â”‚
       â”‚                  â”‚                    â”‚     [deactivate]   â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  14. Response:     â”‚                    â”‚
       â”‚                  â”‚      { success,    â”‚                    â”‚
       â”‚                  â”‚        message,    â”‚                    â”‚
       â”‚                  â”‚        data }      â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  15. Hiá»ƒn thá»‹    â”‚                    â”‚                    â”‚
       â”‚      thÃ´ng bÃ¡o   â”‚                    â”‚                    â”‚
       â”‚      thÃ nh cÃ´ng  â”‚                    â”‚                    â”‚
       â”‚      Reset form  â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
```

**Chi tiáº¿t:**
- **Actor**: Admin (CLUB_LEADER hoáº·c SUPER_ADMIN)
- **Objects**: Frontend, API Route `/api/members`, Database (User, Membership)
- **Luá»“ng chÃ­nh**:
  1. Admin Ä‘iá»n form thÃ´ng tin thÃ nh viÃªn
  2. Frontend validate form
  3. Gá»­i POST request
  4. API kiá»ƒm tra xÃ¡c thá»±c vÃ  quyá»n
  5. Validate dá»¯ liá»‡u
  6-7. Kiá»ƒm tra user Ä‘Ã£ tá»“n táº¡i
  8. Hash password
  9-10. Táº¡o vÃ  lÆ°u User
  11-12. Táº¡o vÃ  lÆ°u Membership (status: ACTIVE)
  13-14. Tráº£ vá» response
  15. Frontend hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng

---

## 4. Duyá»‡t ThÃ nh ViÃªn CLB (Approve Membership)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Admin    â”‚    â”‚   Frontend   â”‚    â”‚   API Route  â”‚    â”‚   Database   â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ /api/        â”‚    â”‚              â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ memberships  â”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  1. Xem danh sÃ¡châ”‚                    â”‚                    â”‚
       â”‚     thÃ nh viÃªn   â”‚                    â”‚                    â”‚
       â”‚     chá» duyá»‡t    â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  2. GET /api/      â”‚                    â”‚
       â”‚                  â”‚     memberships    â”‚                    â”‚
       â”‚                  â”‚     ?status=PENDINGâ”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  3. Kiá»ƒm tra xÃ¡c   â”‚
       â”‚                  â”‚                    â”‚     thá»±c (JWT)     â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  4. TÃ¬m membershipsâ”‚
       â”‚                  â”‚                    â”‚     vá»›i status=    â”‚
       â”‚                  â”‚                    â”‚     PENDING        â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  5. Membership docsâ”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  6. Danh sÃ¡ch      â”‚                    â”‚
       â”‚                  â”‚     memberships    â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  7. Hiá»ƒn thá»‹ danhâ”‚                    â”‚                    â”‚
       â”‚     sÃ¡ch         â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  8. Chá»n thÃ nh   â”‚                    â”‚                    â”‚
       â”‚     viÃªn cáº§n     â”‚                    â”‚                    â”‚
       â”‚     duyá»‡t        â”‚                    â”‚                    â”‚
       â”‚     Nháº¥n "Duyá»‡t" â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  9. PATCH /api/    â”‚                    â”‚
       â”‚                  â”‚     memberships    â”‚                    â”‚
       â”‚                  â”‚     { membershipId,â”‚                    â”‚
       â”‚                  â”‚       action:      â”‚                    â”‚
       â”‚                  â”‚       'approve' }  â”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  10. Kiá»ƒm tra xÃ¡c  â”‚
       â”‚                  â”‚                    â”‚      thá»±c (JWT)    â”‚
       â”‚                  â”‚                    â”‚      Kiá»ƒm tra quyá»nâ”‚
       â”‚                  â”‚                    â”‚      [activate]    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  11. TÃ¬m membershipâ”‚
       â”‚                  â”‚                    â”‚      trong DB      â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  12. Membership docâ”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  13. Kiá»ƒm tra      â”‚
       â”‚                  â”‚                    â”‚      status há»£p lá»‡ â”‚
       â”‚                  â”‚                    â”‚      (PENDING/     â”‚
       â”‚                  â”‚                    â”‚       REJECTED)    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  14. Gá»i method    â”‚
       â”‚                  â”‚                    â”‚      membership.   â”‚
       â”‚                  â”‚                    â”‚      approve()     â”‚
       â”‚                  â”‚                    â”‚      - Set status: â”‚
       â”‚                  â”‚                    â”‚        ACTIVE      â”‚
       â”‚                  â”‚                    â”‚      - Set approvedâ”‚
       â”‚                  â”‚                    â”‚        By, At      â”‚
       â”‚                  â”‚                    â”‚      [activate]    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  15. Cáº­p nháº­t User â”‚
       â”‚                  â”‚                    â”‚      - Set role:   â”‚
       â”‚                  â”‚                    â”‚        CLUB_STUDENTâ”‚
       â”‚                  â”‚                    â”‚      - Set         â”‚
       â”‚                  â”‚                    â”‚        isClubMemberâ”‚
       â”‚                  â”‚                    â”‚        = true      â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  16. User updated  â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  17. LÆ°u membershipâ”‚
       â”‚                  â”‚                    â”‚      vÃ o DB        â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  18. Membership    â”‚
       â”‚                  â”‚                    â”‚      saved         â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  19. Response:     â”‚
       â”‚                  â”‚                    â”‚      { success,    â”‚
       â”‚                  â”‚                    â”‚        message,    â”‚
       â”‚                  â”‚                    â”‚        data }      â”‚
       â”‚                  â”‚                    â”‚     [deactivate]   â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  20. Response:     â”‚                    â”‚
       â”‚                  â”‚      { success,    â”‚                    â”‚
       â”‚                  â”‚        message,    â”‚                    â”‚
       â”‚                  â”‚        data }      â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  21. Hiá»ƒn thá»‹    â”‚                    â”‚                    â”‚
       â”‚      thÃ´ng bÃ¡o   â”‚                    â”‚                    â”‚
       â”‚      thÃ nh cÃ´ng  â”‚                    â”‚                    â”‚
       â”‚      Reload danh â”‚                    â”‚                    â”‚
       â”‚      sÃ¡ch        â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
```

**Chi tiáº¿t:**
- **Actor**: Admin (CLUB_LEADER, SUPER_ADMIN, CLUB_DEPUTY, CLUB_MEMBER)
- **Objects**: Frontend, API Route `/api/memberships`, Database (Membership, User)
- **Luá»“ng chÃ­nh**:
  1-7. Admin xem danh sÃ¡ch thÃ nh viÃªn chá» duyá»‡t
  8. Admin chá»n vÃ  nháº¥n "Duyá»‡t"
  9. Gá»­i PATCH request
  10-12. API kiá»ƒm tra xÃ¡c thá»±c vÃ  tÃ¬m membership
  13. Kiá»ƒm tra status há»£p lá»‡
  14. Gá»i method `membership.approve()`
  15-16. Cáº­p nháº­t User (role, isClubMember)
  17-18. LÆ°u membership
  19-20. Tráº£ vá» response
  21. Frontend hiá»ƒn thá»‹ thÃ´ng bÃ¡o vÃ  reload danh sÃ¡ch

---

## 5. Duyá»‡t ÄÄƒng KÃ½ Tham Gia Hoáº¡t Äá»™ng (Approve Participant)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Admin    â”‚    â”‚   Frontend   â”‚    â”‚   API Route  â”‚    â”‚   Database   â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ /api/        â”‚    â”‚              â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ activities/  â”‚    â”‚              â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ [id]/        â”‚    â”‚              â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ participants â”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  1. Xem danh sÃ¡châ”‚                    â”‚                    â”‚
       â”‚     ngÆ°á»i tham giaâ”‚                    â”‚                    â”‚
       â”‚     hoáº¡t Ä‘á»™ng     â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  2. GET /api/      â”‚                    â”‚
       â”‚                  â”‚     activities/    â”‚                    â”‚
       â”‚                  â”‚     [id]/          â”‚                    â”‚
       â”‚                  â”‚     participants   â”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  3. Kiá»ƒm tra xÃ¡c   â”‚
       â”‚                  â”‚                    â”‚     thá»±c (JWT)     â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  4. TÃ¬m Activity   â”‚
       â”‚                  â”‚                    â”‚     trong DB       â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  5. Activity doc   â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  6. Danh sÃ¡ch      â”‚                    â”‚
       â”‚                  â”‚     participants   â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  7. Hiá»ƒn thá»‹ danhâ”‚                    â”‚                    â”‚
       â”‚     sÃ¡ch vá»›i     â”‚                    â”‚                    â”‚
       â”‚     tráº¡ng thÃ¡i   â”‚                    â”‚                    â”‚
       â”‚     (pending/    â”‚                    â”‚                    â”‚
       â”‚      approved/   â”‚                    â”‚                    â”‚
       â”‚      rejected)   â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  8. Chá»n ngÆ°á»i   â”‚                    â”‚                    â”‚
       â”‚     tham gia     â”‚                    â”‚                    â”‚
       â”‚     Nháº¥n "Duyá»‡t" â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  9. PATCH /api/    â”‚                    â”‚
       â”‚                  â”‚     activities/    â”‚                    â”‚
       â”‚                  â”‚     [id]/          â”‚                    â”‚
       â”‚                  â”‚     participants/  â”‚                    â”‚
       â”‚                  â”‚     [participantId]â”‚                    â”‚
       â”‚                  â”‚     { approvalStatus:â”‚                  â”‚
       â”‚                  â”‚       'approved',  â”‚                    â”‚
       â”‚                  â”‚       approvedBy:  â”‚                    â”‚
       â”‚                  â”‚       admin.userId }â”‚                   â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  10. Kiá»ƒm tra xÃ¡c  â”‚
       â”‚                  â”‚                    â”‚      thá»±c (JWT)    â”‚
       â”‚                  â”‚                    â”‚      Kiá»ƒm tra quyá»nâ”‚
       â”‚                  â”‚                    â”‚      [activate]    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  11. TÃ¬m Activity  â”‚
       â”‚                  â”‚                    â”‚      trong DB      â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  12. Activity doc  â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  13. TÃ¬m participantâ”‚
       â”‚                  â”‚                    â”‚      trong         â”‚
       â”‚                  â”‚                    â”‚      participants[]â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  14. Cáº­p nháº­t      â”‚
       â”‚                  â”‚                    â”‚      participant:  â”‚
       â”‚                  â”‚                    â”‚      - approvalStatus:â”‚
       â”‚                  â”‚                    â”‚        'approved'  â”‚
       â”‚                  â”‚                    â”‚      - approvedBy: â”‚
       â”‚                  â”‚                    â”‚        admin.userIdâ”‚
       â”‚                  â”‚                    â”‚      - approvedAt: â”‚
       â”‚                  â”‚                    â”‚        new Date()  â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  15. LÆ°u Activity  â”‚
       â”‚                  â”‚                    â”‚      vÃ o DB        â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  16. Activity savedâ”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  17. Response:     â”‚
       â”‚                  â”‚                    â”‚      { success,    â”‚
       â”‚                  â”‚                    â”‚        message,    â”‚
       â”‚                  â”‚                    â”‚        data }      â”‚
       â”‚                  â”‚                    â”‚     [deactivate]   â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  18. Response:     â”‚                    â”‚
       â”‚                  â”‚      { success,    â”‚                    â”‚
       â”‚                  â”‚        message,    â”‚                    â”‚
       â”‚                  â”‚        data }      â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  19. Hiá»ƒn thá»‹    â”‚                    â”‚                    â”‚
       â”‚      thÃ´ng bÃ¡o   â”‚                    â”‚                    â”‚
       â”‚      thÃ nh cÃ´ng  â”‚                    â”‚                    â”‚
       â”‚      Cáº­p nháº­t UI â”‚                    â”‚                    â”‚
       â”‚      Reload danh â”‚                    â”‚                    â”‚
       â”‚      sÃ¡ch        â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
```

**Chi tiáº¿t:**
- **Actor**: Admin/Officer (CLUB_LEADER, SUPER_ADMIN, CLUB_DEPUTY, CLUB_MEMBER)
- **Objects**: Frontend, API Route `/api/activities/[id]/participants`, Database (Activity)
- **Luá»“ng chÃ­nh**:
  1-7. Admin xem danh sÃ¡ch ngÆ°á»i tham gia
  8. Admin chá»n vÃ  nháº¥n "Duyá»‡t"
  9. Gá»­i PATCH request
  10-12. API kiá»ƒm tra xÃ¡c thá»±c vÃ  tÃ¬m Activity
  13. TÃ¬m participant trong participants[]
  14. Cáº­p nháº­t approvalStatus, approvedBy, approvedAt
  15-16. LÆ°u Activity vÃ o database
  17-18. Tráº£ vá» response
  19. Frontend cáº­p nháº­t UI vÃ  reload danh sÃ¡ch

---

## ðŸ“ KÃ½ Hiá»‡u Sá»­ Dá»¥ng

- **â”Œâ”€â”**: Object/Component
- **â”€â”€â”€>**: Message (Synchronous call)
- **<â”€â”€â”€**: Return message
- **[activate]**: Activation box (thá»i gian hoáº¡t Ä‘á»™ng)
- **â”‚**: Lifeline (vÃ²ng Ä‘á»i cá»§a object)
- **Actor**: NgÆ°á»i dÃ¹ng (Admin)

---

## ðŸ” Ghi ChÃº

1. **XÃ¡c thá»±c**: Táº¥t cáº£ cÃ¡c API calls Ä‘á»u yÃªu cáº§u JWT token
2. **Quyá»n truy cáº­p**: Má»—i API kiá»ƒm tra role cá»§a user
3. **Database**: Sá»­ dá»¥ng MongoDB vá»›i Mongoose ODM
4. **Error Handling**: Táº¥t cáº£ cÃ¡c luá»“ng Ä‘á»u cÃ³ xá»­ lÃ½ lá»—i
5. **Validation**: Dá»¯ liá»‡u Ä‘Æ°á»£c validate á»Ÿ cáº£ Frontend vÃ  Backend

---

---

## 6. Duyá»‡t Äiá»ƒm Danh (Approve Attendance)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Admin    â”‚    â”‚   Frontend   â”‚    â”‚   API Route  â”‚    â”‚   Database   â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ /api/        â”‚    â”‚              â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ attendance/  â”‚    â”‚              â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ [id]/verify  â”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  1. Xem danh sÃ¡châ”‚                    â”‚                    â”‚
       â”‚     Ä‘iá»ƒm danh    â”‚                    â”‚                    â”‚
       â”‚     chá» duyá»‡t    â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  2. GET /api/      â”‚                    â”‚
       â”‚                  â”‚     activities/    â”‚                    â”‚
       â”‚                  â”‚     [id]/attendanceâ”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  3. Kiá»ƒm tra xÃ¡c   â”‚
       â”‚                  â”‚                    â”‚     thá»±c (JWT)     â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  4. TÃ¬m Activity   â”‚
       â”‚                  â”‚                    â”‚     vÃ  Attendance  â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  5. Attendance docsâ”‚
       â”‚                  â”‚                    â”‚     vá»›i status=    â”‚
       â”‚                  â”‚                    â”‚     pending        â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  6. Danh sÃ¡ch      â”‚                    â”‚
       â”‚                  â”‚     Ä‘iá»ƒm danh      â”‚                    â”‚
       â”‚                  â”‚     (pending)      â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  7. Hiá»ƒn thá»‹ danhâ”‚                    â”‚                    â”‚
       â”‚     sÃ¡ch vá»›i     â”‚                    â”‚                    â”‚
       â”‚     thÃ´ng tin    â”‚                    â”‚                    â”‚
       â”‚     (áº£nh, vá»‹ trÃ­,â”‚                    â”‚                    â”‚
       â”‚     thá»i gian)   â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  8. Chá»n Ä‘iá»ƒm    â”‚                    â”‚                    â”‚
       â”‚     danh cáº§n     â”‚                    â”‚                    â”‚
       â”‚     duyá»‡t        â”‚                    â”‚                    â”‚
       â”‚     Nháº­p ghi chÃº â”‚                    â”‚                    â”‚
       â”‚     (náº¿u cáº§n)    â”‚                    â”‚                    â”‚
       â”‚     Nháº¥n "Duyá»‡t" â”‚                    â”‚                    â”‚
       â”‚     hoáº·c "Tá»« chá»‘i"â”‚                   â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  9. PATCH /api/    â”‚                    â”‚
       â”‚                  â”‚     attendance/    â”‚                    â”‚
       â”‚                  â”‚     [recordId]/    â”‚                    â”‚
       â”‚                  â”‚     verify         â”‚                    â”‚
       â”‚                  â”‚     { status:      â”‚                    â”‚
       â”‚                  â”‚       'approved'|  â”‚                    â”‚
       â”‚                  â”‚       'rejected',  â”‚                    â”‚
       â”‚                  â”‚       verificationNote,â”‚                â”‚
       â”‚                  â”‚       cancelReason }â”‚                   â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  10. Kiá»ƒm tra xÃ¡c  â”‚
       â”‚                  â”‚                    â”‚      thá»±c (JWT)    â”‚
       â”‚                  â”‚                    â”‚      Kiá»ƒm tra quyá»nâ”‚
       â”‚                  â”‚                    â”‚      (CLUB_DEPUTY, â”‚
       â”‚                  â”‚                    â”‚       CLUB_MEMBER, â”‚
       â”‚                  â”‚                    â”‚       CLUB_LEADER, â”‚
       â”‚                  â”‚                    â”‚       SUPER_ADMIN) â”‚
       â”‚                  â”‚                    â”‚      [activate]    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  11. TÃ¬m Attendanceâ”‚
       â”‚                  â”‚                    â”‚      document chá»©a â”‚
       â”‚                  â”‚                    â”‚      recordId      â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  12. Attendance docâ”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  13. TÃ¬m record    â”‚
       â”‚                  â”‚                    â”‚      trong array   â”‚
       â”‚                  â”‚                    â”‚      attendances[] â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  14. Cáº­p nháº­t record:â”‚
       â”‚                  â”‚                    â”‚      - status:     â”‚
       â”‚                  â”‚                    â”‚        'approved'| â”‚
       â”‚                  â”‚                    â”‚        'rejected'  â”‚
       â”‚                  â”‚                    â”‚      - verifiedBy: â”‚
       â”‚                  â”‚                    â”‚        admin.userIdâ”‚
       â”‚                  â”‚                    â”‚      - verifiedAt: â”‚
       â”‚                  â”‚                    â”‚        new Date()  â”‚
       â”‚                  â”‚                    â”‚      - verificationNote:â”‚
       â”‚                  â”‚                    â”‚        (náº¿u cÃ³)    â”‚
       â”‚                  â”‚                    â”‚      - cancelReason:â”‚
       â”‚                  â”‚                    â”‚        (náº¿u reject)â”‚
       â”‚                  â”‚                    â”‚      [activate]    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  15. Mark array    â”‚
       â”‚                  â”‚                    â”‚      as modified   â”‚
       â”‚                  â”‚                    â”‚      LÆ°u Attendanceâ”‚
       â”‚                  â”‚                    â”‚      vÃ o DB        â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  16. Attendance    â”‚
       â”‚                  â”‚                    â”‚      saved         â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  17. Populate      â”‚
       â”‚                  â”‚                    â”‚      verifiedBy    â”‚
       â”‚                  â”‚                    â”‚      user info     â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  18. User info     â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  19. Response:     â”‚
       â”‚                  â”‚                    â”‚      { success,    â”‚
       â”‚                  â”‚                    â”‚        message,    â”‚
       â”‚                  â”‚                    â”‚        data: {     â”‚
       â”‚                  â”‚                    â”‚          attendanceâ”‚
       â”‚                  â”‚                    â”‚        } }         â”‚
       â”‚                  â”‚                    â”‚     [deactivate]   â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  20. Response:     â”‚                    â”‚
       â”‚                  â”‚      { success,    â”‚                    â”‚
       â”‚                  â”‚        message,    â”‚                    â”‚
       â”‚                  â”‚        data }      â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  21. Hiá»ƒn thá»‹    â”‚                    â”‚                    â”‚
       â”‚      thÃ´ng bÃ¡o   â”‚                    â”‚                    â”‚
       â”‚      thÃ nh cÃ´ng  â”‚                    â”‚                    â”‚
       â”‚      Reload danh â”‚                    â”‚                    â”‚
       â”‚      sÃ¡ch Ä‘iá»ƒm   â”‚                    â”‚                    â”‚
       â”‚      danh        â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
```

**Chi tiáº¿t:**
- **Actor**: Admin/Officer (CLUB_DEPUTY, CLUB_MEMBER, CLUB_LEADER, SUPER_ADMIN)
- **Objects**: Frontend, API Route `/api/attendance/[id]/verify`, Database (Attendance, User)
- **Luá»“ng chÃ­nh**:
  1-7. Admin xem danh sÃ¡ch Ä‘iá»ƒm danh chá» duyá»‡t
  8. Admin chá»n vÃ  nháº¥n "Duyá»‡t" hoáº·c "Tá»« chá»‘i"
  9. Gá»­i PATCH request
  10-12. API kiá»ƒm tra xÃ¡c thá»±c vÃ  tÃ¬m Attendance document
  13. TÃ¬m record trong array attendances[]
  14. Cáº­p nháº­t status, verifiedBy, verifiedAt, verificationNote/cancelReason
  15-16. LÆ°u Attendance vÃ o database
  17-18. Populate verifiedBy user info
  19-20. Tráº£ vá» response
  21. Frontend hiá»ƒn thá»‹ thÃ´ng bÃ¡o vÃ  reload danh sÃ¡ch

---

## 7. Xem Danh SÃ¡ch Hoáº¡t Äá»™ng (List Activities)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Admin    â”‚    â”‚   Frontend   â”‚    â”‚   API Route  â”‚    â”‚   Database   â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ /api/        â”‚    â”‚              â”‚
â”‚             â”‚    â”‚              â”‚    â”‚ activities   â”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  1. VÃ o trang    â”‚                    â”‚                    â”‚
       â”‚     danh sÃ¡ch    â”‚                    â”‚                    â”‚
       â”‚     hoáº¡t Ä‘á»™ng    â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  2. GET /api/      â”‚                    â”‚
       â”‚                  â”‚     activities     â”‚                    â”‚
       â”‚                  â”‚     ?page=1&limit= â”‚                    â”‚
       â”‚                  â”‚     10&status=     â”‚                    â”‚
       â”‚                  â”‚     all&type=all   â”‚                    â”‚
       â”‚                  â”‚     &search=       â”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  3. Kiá»ƒm tra xÃ¡c   â”‚
       â”‚                  â”‚                    â”‚     thá»±c (JWT)     â”‚
       â”‚                  â”‚                    â”‚     [activate]     â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  4. Parse query    â”‚
       â”‚                  â”‚                    â”‚     parameters     â”‚
       â”‚                  â”‚                    â”‚     (page, limit,  â”‚
       â”‚                  â”‚                    â”‚      status, type, â”‚
       â”‚                  â”‚                    â”‚      search)       â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  5. Build filter   â”‚
       â”‚                  â”‚                    â”‚     object         â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  6. TÃ¬m Activities â”‚
       â”‚                  â”‚                    â”‚     vá»›i filter vÃ   â”‚
       â”‚                  â”‚                    â”‚     pagination     â”‚
       â”‚                  â”‚                    â”‚     Populate       â”‚
       â”‚                  â”‚                    â”‚     responsiblePer â”‚
       â”‚                  â”‚                    â”‚     son, createdBy â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  7. Activity docs  â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  8. Äáº¿m total      â”‚
       â”‚                  â”‚                    â”‚     activities     â”‚
       â”‚                  â”‚                    â”‚     vá»›i filter     â”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  9. Total count    â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  10. TÃ­nh toÃ¡n     â”‚
       â”‚                  â”‚                    â”‚      pagination    â”‚
       â”‚                  â”‚                    â”‚      (totalPages,  â”‚
       â”‚                  â”‚                    â”‚       hasNextPage, â”‚
       â”‚                  â”‚                    â”‚       hasPrevPage) â”‚
       â”‚                  â”‚                    â”‚     [deactivate]   â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  11. Response:     â”‚                    â”‚
       â”‚                  â”‚      { success,    â”‚                    â”‚
       â”‚                  â”‚        data: {     â”‚                    â”‚
       â”‚                  â”‚          activities,â”‚                   â”‚
       â”‚                  â”‚          paginationâ”‚                    â”‚
       â”‚                  â”‚        } }         â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  12. Hiá»ƒn thá»‹    â”‚                    â”‚                    â”‚
       â”‚      danh sÃ¡ch   â”‚                    â”‚                    â”‚
       â”‚      hoáº¡t Ä‘á»™ng   â”‚                    â”‚                    â”‚
       â”‚      vá»›i phÃ¢n    â”‚                    â”‚                    â”‚
       â”‚      trang       â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  13. Lá»c theo    â”‚                    â”‚                    â”‚
       â”‚      tiÃªu chÃ­    â”‚                    â”‚                    â”‚
       â”‚      (status,    â”‚                    â”‚                    â”‚
       â”‚       type,      â”‚                    â”‚                    â”‚
       â”‚       search)    â”‚                    â”‚                    â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  14. Cáº­p nháº­t URL  â”‚                    â”‚
       â”‚                  â”‚      vá»›i query     â”‚                    â”‚
       â”‚                  â”‚      parameters    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  15. Gá»­i láº¡i GET   â”‚                    â”‚
       â”‚                  â”‚      request vá»›i   â”‚                    â”‚
       â”‚                  â”‚      filter má»›i    â”‚                    â”‚
       â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  16. TÃ¬m Activitiesâ”‚
       â”‚                  â”‚                    â”‚      vá»›i filter má»›iâ”‚
       â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚  17. Filtered      â”‚
       â”‚                  â”‚                    â”‚      activities    â”‚
       â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚                  â”‚  18. Response:     â”‚                    â”‚
       â”‚                  â”‚      { success,    â”‚                    â”‚
       â”‚                  â”‚        data }      â”‚                    â”‚
       â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
       â”‚  19. Cáº­p nháº­t UI â”‚                    â”‚                    â”‚
       â”‚      vá»›i káº¿t quáº£ â”‚                    â”‚                    â”‚
       â”‚      lá»c         â”‚                    â”‚                    â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                    â”‚
       â”‚                  â”‚                    â”‚                    â”‚
```

**Chi tiáº¿t:**
- **Actor**: Admin
- **Objects**: Frontend, API Route `/api/activities`, Database (Activity)
- **Luá»“ng chÃ­nh**:
  1. Admin vÃ o trang danh sÃ¡ch hoáº¡t Ä‘á»™ng
  2. Gá»­i GET request vá»›i query parameters
  3-5. API kiá»ƒm tra xÃ¡c thá»±c vÃ  parse query parameters
  6-7. TÃ¬m Activities vá»›i filter vÃ  pagination
  8-9. Äáº¿m total activities
  10. TÃ­nh toÃ¡n pagination info
  11. Tráº£ vá» response
  12. Frontend hiá»ƒn thá»‹ danh sÃ¡ch
  13-19. Admin lá»c theo tiÃªu chÃ­ vÃ  cáº­p nháº­t UI

---

**TÃ i liá»‡u nÃ y cung cáº¥p cÃ¡c Sequence Diagrams chi tiáº¿t cho cÃ¡c luá»“ng chÃ­nh cá»§a Admin! ðŸŽ‰**

